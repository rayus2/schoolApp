<!--
=========================================================
* Argon Dashboard - v1.2.0
=========================================================
* Product Page: https://www.creative-tim.com/product/argon-dashboard


* Copyright  Creative Tim (http://www.creative-tim.com)
* Coded by www.creative-tim.com



=========================================================
* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description"
	content="Start your development with a Dashboard for Bootstrap 4.">
<meta name="author" content="Creative Tim">
<title>KH-Bootcamp B2 - School App</title>

<!-- Favicon -->
<link rel="icon" href="../assets/img/brand/logo.png" type="image/png">

<!-- Fonts -->
<link rel="stylesheet"
	href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700">

<!-- Icons -->
<link rel="stylesheet" href="../assets/vendor/nucleo/css/nucleo.css">
<link rel="stylesheet"
	href="../assets/vendor/@fortawesome/fontawesome-free/css/all.min.css"
	type="text/css">

<!-- Page plugins -->
<!-- Argon CSS -->
<link rel="stylesheet" href="../assets/css/argon.css?v=1.2.0"
	type="text/css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
	<!-- Sidenav -->
	<nav
		class="sidenav navbar navbar-vertical  fixed-left  navbar-expand-xs navbar-light bg-white">
		<div class="scrollbar-inner">
			<!-- Brand -->
			<div class="sidenav-header  align-items-center" style="height: auto">
				<a class="navbar-brand pb-0" href="/mp2"> <img
					src="../assets/img/brand/appDesign.png" class="navbar-brand-img"
					alt="..." id="logo">
				</a>
			</div>
			<div id="sidenav-main"></div>
		</div>
	</nav>


	<!-- Main content -->
	<div class="main-content" id="panel">

		<div id="content">

			<!-- Header -->
			<div class="header bg-primary pb-6">
				<div class="container-fluid">
					<div class="header-body">
						<div class="row align-items-center py-4">
							<div class="col-lg-6 col-7">
								<nav aria-label="breadcrumb"
									class="d-none d-md-inline-block md-4">
									<ol class="breadcrumb breadcrumb-links breadcrumb-dark">
										<li class="breadcrumb-item"><a href="#"><i
												class="fas fa-home"></i></a></li>
										<li class="breadcrumb-item"><a href="#">Transaksi</a></li>
										<li class="breadcrumb-item active" aria-current="page">SPP</li>
									</ol>
								</nav>
							</div>

						</div>

					</div>
				</div>
			</div>

			<!-- Page content -->
			<div class="container-fluid mt--6">
				<div class="row justify-content-center">
					<div class="col">
						<div class="card">
							<div class="card-header bg-transparent">
								<h3 class="mb-0">Sumbangan Pembinaan Pendidikan (SPP)</h3>
							</div>
							<div class="card-body">
								<form th:action="@{save_spp}" method="post">
									<div class="row justify-content-center">
										<div class="col-md-3">
										 	<div class="form-group">
										        <label for="example-text-input" class="form-control-label pl-1">No.SPP</label>
										        <input class="form-control" type="text" placeholder="SPP001" name="no_spp">
										    </div>
										</div>
										<div class="col-md-3">
										 	<div class="form-group">
										        <label for="example-text-input" class="form-control-label pl-1">Tanggal SPP</label>
										        <input class="form-control" type="date" placeholder="Pilih Tanggal" name="tgl_spp">
										    </div>
										</div>

										<div class="col-md-3">
											<div class="form-group">
										        <label for="example-text-input" class="form-control-label pl-1">Bulan</label>
												<select class="form-control" name="bulan_spp">
													<option>-- Pilih Bulan --</option>
													<option value="Januari">Januari</option>
													<option value="Februari">Februari</option>
													<option value="Maret">Maret</option>
													<option value="April">April</option>
													<option value="Mei">Mei</option>
													<option value="Juni">Juni</option>
													<option value="Juli">Juli</option>
													<option value="Agustus">Agustus</option>
													<option value="September">September</option>
													<option value="Oktober">Oktober</option>
													<option value="November">November</option>
													<option value="Desember">Desember</option>
												</select>
											</div>
										</div>
										<div class="col-md-3">
										 	<div class="form-group">
										        <label for="example-text-input" class="form-control-label pl-1">Tahun Ajar</label>
												<select class="form-control" name="tahunajar_spp">
													<option>-- Pilih Tahun Ajar --</option>
													<option value="Semester Ganjil">Semester Ganjil</option>
													<option value="Semester Genap">Semester Genap</option>
												</select>
											</div>
										</div>

									</div>
								


									<div class="row">
										<div class="col-md-12 text-right">
											<button type="button" class="btn btn-sm btn-info" id="pilih-siswa">Pilih Siswa</button>
										</div>
									</div>
									
									<div class="table-responsive pt-2 pb-4">
										<table class="table align-items-center table-flush">
											<thead class="thead-light">
												<tr>
													<th>NIM</th>
													<th>Nama Siswa</th>
													<th>Kelas</th>
													<th>SPP</th>
													<th>Action</th>
												</tr>
											</thead>
											<tbody class="list" id="list_sppsiswa">
																				
											</tbody>
										</table>
									</div>

									<div class="row justify-content-center">
										<div class="col-md-3">
											<div class="form-group">
											    <label for="example-text-input" class="form-control-label pl-1">Total Bayar SPP</label>
												<div class="input-group">
											        <div class="input-group-prepend">
											            <span class="input-group-text" id="basic-addon1">Rp</span>
											        </div>
											        <input type="text" class="form-control" readonly name="jumlah_spp" id="jumlah_spp" value="0">
											    </div>
											</div>
										</div>
										<div class="col-md-3">
											<div class="form-group">
												<label class="form-control-label pl-1">Tipe Bayar</label>
												<select class="form-control" name="tipebayar_spp" id="selection_tipebayar">
													<option>-- Pilih Tipe Bayar--</option>
													<option value="Cash">Cash</option>
													<option value="Cicilan">Cicilan</option>
												</select>
											</div>
										</div>
										<div class="col-md-3">
											<div class="form-group">
												<label for="example-text-input" class="form-control-label pl-1">Bayar</label>
												<div class="input-group">
											        <div class="input-group-prepend">
											            <span class="input-group-text" id="basic-addon1">Rp</span>
											        </div>
											        <input type="text" class="form-control" name="bayar_spp" id="bayar_spp" value="0">
											    </div>
											</div>
										</div>
										<div class="col-md-3">
											<div class="form-group">
												<label class="form-control-label pl-1" id="kembalian_spp_label">Kembalian</label>
												<div class="input-group">
											        <div class="input-group-prepend">
											            <span class="input-group-text" id="basic-addon1" >Rp</span>
											        </div>
											        <input type="text" class="form-control" readonly name="kembalian_spp" id="kembalian_spp" value="0">
											    </div>
											</div>
										</div>
									</div>
									<div class="col-md-13 text-right">
									<button type="button" class="btn btn-info" id="hitung">Hitung</button>
									
									<button type="submit" class="btn btn-success" id="submit">Submit</button>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
			
				<!-- Footer -->
				<footer class="footer pt-0">
					<div class="row align-items-center justify-content-lg-between">
						<div class="col-lg-6">
							<div class="copyright text-center  text-lg-left  text-muted">
								&copy; 2021 <a href="https://www.creative-tim.com"
									class="font-weight-bold ml-1" target="_blank">Kodehive
									Bootcamp - Batch 2</a>
							</div>
						</div>
						<div class="col-lg-6">
							<ul
								class="nav nav-footer justify-content-center justify-content-lg-end">
								<li class="nav-item"><a href="https://www.creative-tim.com"
									class="nav-link" target="_blank">Randy</a></li>
								<li class="nav-item"><a
									href="https://www.creative-tim.com/presentation"
									class="nav-link" target="_blank">Satrio</a></li>
								<li class="nav-item"><a href="http://blog.creative-tim.com"
									class="nav-link" target="_blank">Yustika</a></li>
							</ul>
						</div>
					</div>
				</footer>
			</div>
		
		<div id="modalpilihsiswa">
			<div class="col-md-4">
				<div class="modal fade" id="modal-pilihsiswa" tabindex="-1"
					role="dialog" aria-labelledby="modal-notification" aria-hidden="true">
					<div class="modal-dialog modal- modal-dialog-centered modal-md" role="document">
						<div class="modal-content bg-gradient-secondary">
			
							<div class="modal-header">
								<h3 class="modal-title" id="modal-title-notification">Pilih Siswa</h3>
								<button type="button" class="close" data-dismiss="modal" aria-label="Close">
									<span aria-hidden="true">&times;</span>
								</button>
							</div>
			
							<div class="modal-body">
								<div class="table-responsive pt-2 pb-4">
			
									<table class="table align-items-center table-flush"  >
										<thead class="thead-light">
											<tr>
												<th>NIM</th>
												<th>Nama Siswa</th>
												<th>Kelas</th>
												<th>Action</th>
											</tr>
										</thead>
										<tbody class="list">
											<tr th:each="spp_pilihSiswa:${sppList}">
												<td th:text="${spp_pilihSiswa.nim_siswa}"></td>
												<td th:text="${spp_pilihSiswa.nama_siswa}"></td>
												<td th:text="${spp_pilihSiswa.kelas_siswa}"></td>
												<td><button type="button"
													class="btn btn-info" id="spp_pilih"
													th:value=${spp_pilihSiswa.nim_siswa}>PILIH</button></td>
											</tr>
										</tbody>
									</table>
			
								</div>
							</div>
							<div class="modal-footer"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	
		<div id="modal-success">
			<div class="col-md-4">
				<div class="modal fade" id="modal-success-notif" tabindex="-1"
					role="dialog" aria-labelledby="modal-notification" aria-hidden="true">
					<div class="modal-dialog modal-danger modal-dialog-centered modal-"
						role="document">
						<div class="modal-content bg-gradient-success">
			
							<div class="modal-header">
							</div>
			
							<div class="modal-body">
			
								<div class="py-3 text-center">
									<i class="fas fa-check ni-5x"></i>
									<h4 class="heading m-4">Berhasil Memasukan Data SPP</h4>
								</div>
			
							</div>
			
							<div class="modal-footer">
							</div>
			
						</div>
					</div>
				</div>
			</div>
		
		</div>
	</div>

	
	<!-- Argon Scripts -->
	<!-- Core -->
	<script src="../assets/vendor/jquery/dist/jquery.min.js"></script>
	<script
		src="../assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
	<script src="../assets/vendor/js-cookie/js.cookie.js"></script>
	<script
		src="../assets/vendor/jquery.scrollbar/jquery.scrollbar.min.js"></script>
	<script
		src="../assets/vendor/jquery-scroll-lock/dist/jquery-scrollLock.min.js"></script>
	<!-- Optional JS -->
	<script src="../assets/vendor/chart.js/dist/Chart.min.js"></script>
	<script src="../assets/vendor/chart.js/dist/Chart.extension.js"></script>
	<script
		src="../assets/vendor/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
	<!-- Argon JS -->
	<script src="../assets/js/argon.js?v=1.2.0"></script>

	<script type="text/javascript">
		var spp = 100000;
		var cicilan = 50000;
		
		var kembalian;
		var bayar;
		var bayar_spp;
		$(function() {
			$("#sidenav-main").load("sidenav");
			
			$("#logo").on("click", function() {
				$.ajax({
					url : 'index',
					datType : 'html',
					success : function(result) {
						location.reload(url);
					}
				})
			});
			
			$("#pilih-siswa").on("click", function(){
				$("#modalpilihsiswa #modal-pilihsiswa").modal("show");
			})
			
			$(".table #spp_pilih").on("click", function(){
				var nim_siswa = $(this).val();
				$.ajax({
					type:'get',
					url:'/mp2/siswa/api_getById?nim_siswa='+nim_siswa,
					success: function(result){
						var markup = 	"<tr>"+
									 	"<td>" + result.nim_siswa + "</td>"+
									 	"<td>" + result.nama_siswa + "</td>"+
									 	"<td>" + result.kelas_siswa + "</td>"+
									 	"<td>100000</td>"+
									 	"<td><button type='button' class='btn btn-danger' id='batal'>BATAL</button></td>"+
									 	"</tr>";
			            $("#list_sppsiswa").append(markup);
			    		$("#modalpilihsiswa #modal-pilihsiswa").modal("hide");
			    	
			    		var rowCount = $('.table #list_sppsiswa tr').length;
						var i;
						bayar_spp = 0;
						
						for(i=0; i<rowCount; i++){
							bayar_spp += spp;
						}
						
						$("#jumlah_spp").val(bayar_spp);
						
					}		
				})
			})
			
			$(".table #list_sppsiswa").on("click", "#batal", function(){
	        	
	        	var rowCount = $('.table #list_sppsiswa tr').length;				
        		$(this).parents("tr").remove();		   
				
        		if(rowCount == 0) {
					$("#jumlah_spp").val(0);
					$("#bayar_spp").val(0);
					$('#selection_tipebayar').prop('selectedIndex',0);
				} else {
					bayar_spp -= 100000;
				}	
        		
	    		$("#jumlah_spp").val(bayar_spp);
	    		$("#bayar_spp").val(bayar_spp);
	        	
		    });
			
			$("#submit").on("click", function(){
				$("#modal-success #modal-success-notif").modal("show");	        				
       			setTimeout(function(){
        			$("#modal-success-notif").modal("hide");	        				
       			}, 1000)
       	    });
			
			$('#selection_tipebayar').on('change', function() {
				var tipe = this.value;
				
				var getbayar = $("#jumlah_spp").val()
				var cicil = $("#jumlah_spp").val()
				
				if(tipe = "Cash"){
					$("#bayar_spp").val(getbayar);
				} else {
					$("#bayar_spp").val(cicil/2);	
				}		
			});
			
			$("#hitung").on("click", function(){
				bayar = $("#bayar_spp").val();
				kembalian = bayar - bayar_spp;
				
				if(kembalian < 0) {
					$("#kembalian_spp_label").text("Hutang");
					$("#kembalian_spp").val(kembalian);					
				} else {
					$("#kembalian_spp").val(kembalian);
				}
			})
			
		})
	</script>
</body>

</html>
